# Maze generator

## Sample mazes

If you're just looking for some mazes generated by this program, they are here:

**https://bjacob.github.io/maze.**

## How to build

This is a self-contained C++20 program, `maze.cc`, with no dependencies. It can be built by directly
invoking any C++20 compiler, like

    c++ --std=c++20 -O3 maze.cc -o maze

Alternatively, it can be build using [CMake](https://cmake.org/),

    mkdir build
    cd build
    cmake -DCMAKE_BUILD_TYPE=Release ..
    cmake --build .

## How to run

If you just run `./maze`, it will output HTML to standard output. Try

    ./maze --help

to see available options.

## Algorithm

This program generates random mazes using a variant of the
Twist-and-Merge algorithm from [1], Algorithm 2. The output is a HTML
document containing one maze per page, suitable for printing.

  [1]: V. Bellot, M. Cautrès, J-M. Favreau, M. Gonzalez-Thauvin, P. Lafourcade,
       K. Le Cornec, B. Mosnier, S. Rivière-Wekstein,
       "How to generate perfect mazes?,"
       https://uca.hal.science/hal-03174952/document

The algorithm can be summarized as follows:

0. In the initial state, all maze cells are surrounded by 4 walls. The maze
   generation process consists in dropping select walls.
1. In the first phase, named Twist, one performs random walks across
cells
   that are still surrounded by 4 walls, opening passages between visited
   cells. The random walks are "biased" in the sense that we have parametrized
   preferences for avoiding straight paths and U-turns (see options `--weight_straight_path`
   and `--weight_u_turn` below).
   This results in the twisty maze appearance. This phase ends when all cells
   have been visited by one of the
   random walks. At this point, the maze is not yet connected. it is the
   disconnected union of twisty galleries.
2. In the second phase, named Merge, one removes one randomly-selected wall
   at a time between cells belonging to different connected components. The
   strategy used to select walls to remove is controlled by the `--biased_merge` option
   below. This
   phase stops as soon as the maze is connected. Because of that, the result
   is a maze that is not only connected, but simply connected: there is
   exactly one path connecting any two cells. In other words, the maze is a
   tree graph.

This program slightly generalizes the Twist & Merge algorithm by introducing
3 parameters, corresponding to these command-line parameters. The original
Twise & Merge algorithm can be recovered with specific non-default values:

     --weight_straight_path=
         Float between 0 and 1. Sets the likelihood of straight paths.
             Default 0.25.
             Set to 0 to recover the original Twist & Merge algorithm.
     --weight_u_turn=
         Float between 0 and 1. Sets the likelihood of U-turns.
             Default 0.25.
             Set to 1 to recover the original Twist & Merge algorithm.
     --biased_merge=
         Boolean: true or false. Sets the merge strategy.
             Default true.
             Set to false to recover the original Twist & Merge algorithm.